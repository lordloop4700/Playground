<html>
    <body>
        title = title;
    </body>
</html>


    </head>
    <script>
        //   GetApiData()
            let numberfloat = 0.000000000000000001;
    
            function numberWithCommas(x) {
                return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
            }
            
            // async function GetApiData() {
            //     let xhr = new XMLHttpRequest();
            //     // let pa = JSON.parse(test)
            //     xhr.open('GET', 'https://filfox.info/api/v1/address/f0127595'); //나중에 입력 받아서 모든 머신에 대해서 값을 가져와야함.
            //     // xhr.open('GET', `https://filfox.info/api/v1/address/${pa.mId}`);
                
            //     xhr.onload = await function() {
            //         if (xhr.status === 200 || xhr.status === 201) {        
            //             let parsing_data = xhr.response;
            //             parsing_data = JSON.parse(parsing_data).miner.availableBalance;
            //             
                        
            //             // console.log(dbData[0].value)
                        
            //             // dbD
            //             // let dbData = $('#price').html()
            //             /*
            //                 parsing_data.balance = 계정잔액(FIL)
            //                 parsing_data.miner.availableBalance = 사용 가능 잔액(FIL)
            //                 parsing_data.miner.sectorPledgeBalance = Initial pledge(FIL)
            //             */
            //             // document.getElementById('bal_p').innerHTML = "<h3>" + numberWithCommas((parsing_data.balance*numberfloat).toFixed(2)) + "</h3>"; 
            //             // document.getElementById('avi_p').innerHTML = "<h3>" + numberWithCommas((parsing_data.miner.availableBalance*numberfloat).toFixed(2)) + "</h3>"; //유저의 경우 db로 부터 value값을 가지고 나서 
            //             console.log(typeof dbData)
            //             let availBalance = (parsing_data * numberfloat).toFixed(2)
            //             // $('#price').html((availBalance / 100.0) * (dbData / 10))                    
            //             document.getElementById('bal_p').innerHTML = "<h3>" + numberWithCommas((parsing_data.balance*numberfloat).toFixed(2)) + "</h3>"; 
            //         }   
            //         else
            //             console.log("check filfox response");
            //     }
            //     await xhr.send();
            // }
            
            async function upBitApi() {
                let xhr = new XMLHttpRequest();
                xhr.open('GET', 'https://api.upbit.com/v1/ticker?markets=KRW-BTC');
                
                xhr.onload = await function() {
                    if (xhr.status === 200 || xhr.status === 201) {        
                        let parsing_data = xhr.response;
                        parsing_data = JSON.parse(parsing_data);
                        console.log(parsing_data[0].trade_price)
    
                        document.getElementById('bit').innerHTML = "<h3>" + numberWithCommas(parsing_data[0].trade_price) + "원</h3>"; //fil bitcoin 계산식 
                    }   
                    else
                        console.log("check upbit response");
                }
                await xhr.send();
            }
    
            // async function coinOneApi() {
            //   let xhr = new XMLHttpRequest();
            //   xhr.open('GET', 'https://api.coinone.co.kr/ticker/?currency=fil&format=json')
            //   xhr.setRequestHeader('sec-fetch-mode', 'navigate')
            //   xhr.setRequestHeader('sec-fetch-site', 'none')
            //   xhr.setRequestHeader('sec-fetch-user', '?1')
            //   xhr.setRequestHeader('sec-fetch-dest', 'document')
            //   xhr.setRequestHeader('user-agent', "Mozilla/5.0 (Macintosh; Intel Mac OS X 11_1_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.90 Safari/537.36")
            //   xhr.onload = await function() {
            //   if (xhr.status === 200 || xhr.status === 201) {
            //     console.log(xhr.responseText)
            //     $('#fil').html(JSON.parse(xhr.responseText).last)
            //   } else
            //     console.log("check coinone response")
            //   }
            //   await xhr.send()
            // }
    
            async function coinMarketApi() {
                let xhr = new XMLHttpRequest();
                xhr.open('GET', 'https://api.coingecko.com/api/v3/simple/price?ids=filecoin&vs_currencies=krw');
                
                xhr.onload = await function() {
                    if (xhr.status === 200 || xhr.status === 201) {        
                        let parsing_data = xhr.response;
                        parsing_data = JSON.parse(parsing_data);
                        // console.log(parsing_data)
                        // console.log(parsing_data.filecoin.krw)
    
                        document.getElementById('fil').innerHTML = "<h3>" + numberWithCommas(parsing_data.filecoin.krw) + "원</h3>"; //fil bitcoin 계산식 
                    }   
                    else
                        console.log("check coinmarket response");
                }
                await xhr.send();
            }
    
            upBitApi()
            coinMarketApi()
        </script>
        <body>
        <td class="td1"><div id="bal_p"></div></td>
        <td class="td1"><div id="avi_p"></div></td>
    </body>
</html>
